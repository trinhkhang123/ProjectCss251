import { compile } from 'path-to-regexp';
import { stringify } from 'qs';

var compilePathCache = {};
function compilePath(pattern, params, query) {
    if (!compilePathCache[pattern]) {
        compilePathCache[pattern] = compile(pattern);
    }
    var compiledPath = compilePathCache[pattern](params);
    var stringifiedQuery = query ? stringify(query) : null;
    return stringifiedQuery
        ? (compiledPath + "?" + stringifiedQuery).trim()
        : compiledPath.trim();
}

export { compilePath };
